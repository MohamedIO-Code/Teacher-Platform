module.exports=[93695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},29173,(a,b,c)=>{b.exports=a.x("@prisma/client",()=>require("@prisma/client"))},54799,(a,b,c)=>{b.exports=a.x("crypto",()=>require("crypto"))},874,(a,b,c)=>{b.exports=a.x("buffer",()=>require("buffer"))},88947,(a,b,c)=>{b.exports=a.x("stream",()=>require("stream"))},50645,a=>{a.n(a.i(27572))},43619,a=>{a.n(a.i(79962))},13718,a=>{a.n(a.i(85523))},18198,a=>{a.n(a.i(45518))},62212,a=>{a.n(a.i(66114))},15843,a=>{a.n(a.i(18357))},48505,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/app/dashboard/DashboardClient.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/app/dashboard/DashboardClient.tsx <module evaluation>","default");a.s(["default",0,b])},41443,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/app/dashboard/DashboardClient.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/app/dashboard/DashboardClient.tsx","default");a.s(["default",0,b])},74661,a=>{"use strict";a.i(48505);var b=a.i(41443);a.n(b)},50106,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/app/dashboard/TeacherDashboardClient.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/app/dashboard/TeacherDashboardClient.tsx <module evaluation>","default");a.s(["default",0,b])},43414,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/app/dashboard/TeacherDashboardClient.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/app/dashboard/TeacherDashboardClient.tsx","default");a.s(["default",0,b])},7052,a=>{"use strict";a.i(50106);var b=a.i(43414);a.n(b)},99123,a=>{"use strict";var b=a.i(7997),c=a.i(9307),d=a.i(66518);a.i(70396);var e=a.i(73727),f=a.i(74661),g=a.i(7052);async function h(){let a=new Date;a.setHours(0,0,0,0);let b=new Date(a.getFullYear(),a.getMonth(),1);new Date(a).setDate(a.getDate()-a.getDay());let c=await d.default.teacher.count({where:{status:"active"}}),e=(await d.default.attendance.groupBy({by:["status"],where:{date:{gte:a,lt:new Date(a.getTime()+864e5)}},_count:!0})).reduce((a,b)=>(a[b.status]=b._count,a),{}),f=e.present||0,g=e.late||0,h=e.absent||0,i=f+g+h+(e.excused||0),l=i>0?Math.round((f+g)/i*100):0,m=await d.default.evaluation.aggregate({_avg:{overallScore:!0},_count:!0}),n=m._avg.overallScore?Number(m._avg.overallScore.toFixed(1)):0,o=(await d.default.attendance.groupBy({by:["status"],where:{date:{gte:b}},_count:!0})).reduce((a,b)=>(a[b.status]=b._count,a),{}),p=await d.default.evaluation.count({where:{date:{gte:b}}}),q=await k(),r=await d.default.auditLog.findMany({take:5,orderBy:{createdAt:"desc"},include:{user:{select:{name:!0}}}}),s=await j(),t=await d.default.department.findMany({include:{_count:{select:{teachers:!0}}}});return{totalTeachers:c,attendanceRate:l,presentToday:f+g,absentToday:h,lateToday:g,avgEvaluationScore:n,totalEvaluations:m._count,monthlyEvaluations:p,monthlyStats:{present:o.present||0,absent:o.absent||0,late:o.late||0,excused:o.excused||0},alerts:q,recentActivity:r.map(a=>({id:a.id,action:a.action,entity:a.entity,userName:a.user?.name||"النظام",createdAt:a.createdAt.toISOString()})),weeklyData:s,departmentStats:t.map(a=>({name:a.name,count:a._count.teachers}))}}async function i(a){let b=new Date;b.setHours(0,0,0,0);let c=await d.default.teacher.findUnique({where:{userId:a},select:{id:!0,name:!0,email:!0,phone:!0,employeeId:!0,status:!0,joinDate:!0}});if(!c)return null;let e=(await d.default.attendance.groupBy({by:["status"],where:{teacherId:c.id},_count:!0})).reduce((a,b)=>(a[b.status]=b._count,a),{}),f=await d.default.attendance.findUnique({where:{teacherId_date:{teacherId:c.id,date:b}}}),g=await d.default.evaluation.findMany({where:{teacherId:c.id},orderBy:{date:"desc"},take:5,include:{evaluator:{select:{name:!0}}}}),h=await d.default.note.findMany({where:{teacherId:c.id},orderBy:{createdAt:"desc"},take:5,include:{author:{select:{name:!0}}}});return{teacher:{...c,joinDate:c.joinDate?.toISOString()||null},attendance:{present:e.present||0,absent:e.absent||0,late:e.late||0,excused:e.excused||0,todayStatus:f?.status||null},recentEvaluations:g.map(a=>({id:a.id,date:a.date.toISOString(),overallScore:a.overallScore,comments:a.comments,evaluator:a.evaluator})),recentNotes:h.map(a=>({id:a.id,type:a.type,content:a.content,createdAt:a.createdAt.toISOString(),author:a.author}))}}async function j(){let a=[],b=new Date;for(let c=6;c>=0;c--){let e=new Date(b);e.setDate(e.getDate()-c),e.setHours(0,0,0,0);let f=new Date(e);f.setDate(f.getDate()+1);let g=(await d.default.attendance.groupBy({by:["status"],where:{date:{gte:e,lt:f}},_count:!0})).reduce((a,b)=>(a[b.status]=b._count,a),{});a.push({date:e.toLocaleDateString("ar-SA",{weekday:"short"}),present:(g.present||0)+(g.late||0),absent:g.absent||0})}return a}async function k(){let a=[],b=new Date;b.setHours(0,0,0,0);let c=await d.default.attendance.count({where:{date:{gte:b,lt:new Date(b.getTime()+864e5)},status:"absent"}});c>0&&a.push({type:"warning",message:"مدرسين غائبين اليوم",count:c});let e=await d.default.attendance.count({where:{date:{gte:b,lt:new Date(b.getTime()+864e5)},status:"late"}});e>0&&a.push({type:"info",message:"مدرسين متأخرين اليوم",count:e});let f=await d.default.evaluation.count({where:{overallScore:{lt:6}}});return f>0&&a.push({type:"error",message:"تقييمات منخفضة تحتاج متابعة",count:f}),a}async function l(){let a=await (0,c.getSession)();if(a||(0,e.redirect)("/login"),"parent"===a.role&&(0,e.redirect)("/dashboard/parent"),"teacher"===a.role){let c=await i(a.id);return c?(0,b.jsx)(g.default,{stats:c,userName:a.name}):(0,b.jsxs)("div",{style:{padding:"2rem",textAlign:"center"},children:[(0,b.jsx)("h1",{children:"لم يتم العثور على ملف المدرس"}),(0,b.jsx)("p",{children:"يرجى التواصل مع المسؤول لربط حسابك بملف المدرس"})]})}let d=await h();return(0,b.jsx)(f.default,{stats:d,userName:a.name})}a.s(["default",()=>l])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__2014c9de._.js.map