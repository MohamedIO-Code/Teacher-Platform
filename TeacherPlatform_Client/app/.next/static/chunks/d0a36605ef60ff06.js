(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33920,e=>{e.v({actions:"settings-module___0qqaW__actions",active:"settings-module___0qqaW__active",addBtn:"settings-module___0qqaW__addBtn",badge:"settings-module___0qqaW__badge",badgeGray:"settings-module___0qqaW__badgeGray",badgeGreen:"settings-module___0qqaW__badgeGreen",cancelBtn:"settings-module___0qqaW__cancelBtn",card:"settings-module___0qqaW__card",cardDescription:"settings-module___0qqaW__cardDescription",cardHeader:"settings-module___0qqaW__cardHeader",cardTitle:"settings-module___0qqaW__cardTitle",container:"settings-module___0qqaW__container",content:"settings-module___0qqaW__content",deleteBtn:"settings-module___0qqaW__deleteBtn",editBtn:"settings-module___0qqaW__editBtn",emptyState:"settings-module___0qqaW__emptyState",eyeBtn:"settings-module___0qqaW__eyeBtn",filterSelect:"settings-module___0qqaW__filterSelect",form:"settings-module___0qqaW__form",formError:"settings-module___0qqaW__formError",formGroup:"settings-module___0qqaW__formGroup",formRow:"settings-module___0qqaW__formRow",header:"settings-module___0qqaW__header",headerIcon:"settings-module___0qqaW__headerIcon",input:"settings-module___0qqaW__input",label:"settings-module___0qqaW__label",loader:"settings-module___0qqaW__loader",loadingState:"settings-module___0qqaW__loadingState",modal:"settings-module___0qqaW__modal",modalActions:"settings-module___0qqaW__modalActions",modalForm:"settings-module___0qqaW__modalForm",modalHeader:"settings-module___0qqaW__modalHeader",modalOverlay:"settings-module___0qqaW__modalOverlay",mono:"settings-module___0qqaW__mono",pagination:"settings-module___0qqaW__pagination",passwordInput:"settings-module___0qqaW__passwordInput",saveBtn:"settings-module___0qqaW__saveBtn",searchBox:"settings-module___0qqaW__searchBox",sectionHeader:"settings-module___0qqaW__sectionHeader",select:"settings-module___0qqaW__select",slideUp:"settings-module___0qqaW__slideUp",slider:"settings-module___0qqaW__slider",spin:"settings-module___0qqaW__spin",subTab:"settings-module___0qqaW__subTab",subTabActive:"settings-module___0qqaW__subTabActive",subTabContent:"settings-module___0qqaW__subTabContent",subTabs:"settings-module___0qqaW__subTabs",submitBtn:"settings-module___0qqaW__submitBtn",subtitle:"settings-module___0qqaW__subtitle",tab:"settings-module___0qqaW__tab",tabContent:"settings-module___0qqaW__tabContent",table:"settings-module___0qqaW__table",tableWrap:"settings-module___0qqaW__tableWrap",tabs:"settings-module___0qqaW__tabs",title:"settings-module___0qqaW__title",toast:"settings-module___0qqaW__toast",toggle:"settings-module___0qqaW__toggle",toggleDescription:"settings-module___0qqaW__toggleDescription",toggleItem:"settings-module___0qqaW__toggleItem",toggleList:"settings-module___0qqaW__toggleList",toggleTitle:"settings-module___0qqaW__toggleTitle"})},59772,e=>{"use strict";var a=e.i(43476),s=e.i(71645),t=e.i(39616),l=e.i(84614),d=e.i(70756),i=e.i(45423),n=e.i(61911),r=e.i(32095),c=e.i(82293),o=e.i(75254);let u=(0,o.default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var h=e.i(43531),m=e.i(86536),f=e.i(77705),j=e.i(7233),x=e.i(55436),p=e.i(88511),_=e.i(27612),g=e.i(37727),v=e.i(63059),N=e.i(73375);let b=(0,o.default)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);var y=e.i(33920);function q(){let[e,r]=(0,s.useState)("profile"),[c,o]=(0,s.useState)(!1),[j,x]=(0,s.useState)(!1),[p,_]=(0,s.useState)(!1),[g,v]=(0,s.useState)(!1),[N,b]=(0,s.useState)({name:"",email:""}),[q,C]=(0,s.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[S,k]=(0,s.useState)({emailNotifications:!0,browserNotifications:!0,teacherAlerts:!0,attendanceAlerts:!0,weeklyReport:!1});(0,s.useEffect)(()=>{W()},[]);let W=async()=>{try{let e=await fetch("/api/auth/me");if(e.ok){let a=await e.json();b({name:a.user.name||"",email:a.user.email||""})}}catch(e){console.error("Failed to fetch profile:",e)}},P=async()=>{o(!0);try{(await fetch("/api/auth/update-profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(N)})).ok&&(x(!0),setTimeout(()=>x(!1),3e3))}catch(e){console.error("Failed to update profile:",e)}finally{o(!1)}},T=async()=>{if(q.newPassword!==q.confirmPassword)return void alert("كلمات المرور غير متطابقة");if(q.newPassword.length<6)return void alert("كلمة المرور يجب أن تكون 6 أحرف على الأقل");o(!0);try{let e=await fetch("/api/auth/change-password",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:q.currentPassword,newPassword:q.newPassword})});if(e.ok)x(!0),C({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>x(!1),3e3);else{let a=await e.json();alert(a.error||"فشل تغيير كلمة المرور")}}catch(e){console.error("Failed to change password:",e)}finally{o(!1)}},B=async()=>{o(!0);try{await new Promise(e=>setTimeout(e,500)),x(!0),setTimeout(()=>x(!1),3e3)}finally{o(!1)}},z=[{id:"profile",label:"الملف الشخصي",icon:l.User},{id:"security",label:"الأمان",icon:d.Lock},{id:"notifications",label:"الإشعارات",icon:i.Bell},{id:"users",label:"إدارة المستخدمين",icon:n.Users}];return(0,a.jsxs)("div",{className:y.default.container,children:[(0,a.jsxs)("div",{className:y.default.header,children:[(0,a.jsx)("div",{className:y.default.headerIcon,children:(0,a.jsx)(t.Settings,{size:24})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:y.default.title,children:"الإعدادات"}),(0,a.jsx)("p",{className:y.default.subtitle,children:"إدارة حسابك والمستخدمين"})]})]}),(0,a.jsxs)("div",{className:y.default.content,children:[(0,a.jsx)("div",{className:y.default.tabs,children:z.map(s=>(0,a.jsxs)("button",{className:`${y.default.tab} ${e===s.id?y.default.active:""}`,onClick:()=>r(s.id),children:[(0,a.jsx)(s.icon,{size:18}),s.label]},s.id))}),(0,a.jsxs)("div",{className:y.default.tabContent,children:["profile"===e&&(0,a.jsxs)("div",{className:y.default.card,children:[(0,a.jsx)("h2",{className:y.default.cardTitle,children:"معلومات الملف الشخصي"}),(0,a.jsx)("p",{className:y.default.cardDescription,children:"قم بتحديث معلومات حسابك"}),(0,a.jsxs)("div",{className:y.default.form,children:[(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"الاسم"}),(0,a.jsx)("input",{type:"text",className:y.default.input,value:N.name,onChange:e=>b({...N,name:e.target.value}),placeholder:"أدخل اسمك"})]}),(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"البريد الإلكتروني"}),(0,a.jsx)("input",{type:"email",className:y.default.input,value:N.email,onChange:e=>b({...N,email:e.target.value}),placeholder:"أدخل بريدك الإلكتروني",dir:"ltr"})]}),(0,a.jsxs)("button",{className:y.default.saveBtn,onClick:P,disabled:c,children:[j?(0,a.jsx)(h.Check,{size:18}):(0,a.jsx)(u,{size:18}),j?"تم الحفظ":"حفظ التغييرات"]})]})]}),"security"===e&&(0,a.jsxs)("div",{className:y.default.card,children:[(0,a.jsx)("h2",{className:y.default.cardTitle,children:"تغيير كلمة المرور"}),(0,a.jsx)("p",{className:y.default.cardDescription,children:"تأكد من استخدام كلمة مرور قوية"}),(0,a.jsxs)("div",{className:y.default.form,children:[(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"كلمة المرور الحالية"}),(0,a.jsxs)("div",{className:y.default.passwordInput,children:[(0,a.jsx)("input",{type:p?"text":"password",className:y.default.input,value:q.currentPassword,onChange:e=>C({...q,currentPassword:e.target.value}),placeholder:"أدخل كلمة المرور الحالية",dir:"ltr"}),(0,a.jsx)("button",{type:"button",className:y.default.eyeBtn,onClick:()=>_(!p),children:p?(0,a.jsx)(f.EyeOff,{size:18}):(0,a.jsx)(m.Eye,{size:18})})]})]}),(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"كلمة المرور الجديدة"}),(0,a.jsxs)("div",{className:y.default.passwordInput,children:[(0,a.jsx)("input",{type:g?"text":"password",className:y.default.input,value:q.newPassword,onChange:e=>C({...q,newPassword:e.target.value}),placeholder:"أدخل كلمة المرور الجديدة",dir:"ltr"}),(0,a.jsx)("button",{type:"button",className:y.default.eyeBtn,onClick:()=>v(!g),children:g?(0,a.jsx)(f.EyeOff,{size:18}):(0,a.jsx)(m.Eye,{size:18})})]})]}),(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"تأكيد كلمة المرور الجديدة"}),(0,a.jsx)("input",{type:"password",className:y.default.input,value:q.confirmPassword,onChange:e=>C({...q,confirmPassword:e.target.value}),placeholder:"أعد إدخال كلمة المرور الجديدة",dir:"ltr"})]}),(0,a.jsxs)("button",{className:y.default.saveBtn,onClick:T,disabled:c||!q.currentPassword||!q.newPassword||!q.confirmPassword,children:[j?(0,a.jsx)(h.Check,{size:18}):(0,a.jsx)(d.Lock,{size:18}),j?"تم التغيير":"تغيير كلمة المرور"]})]})]}),"notifications"===e&&(0,a.jsxs)("div",{className:y.default.card,children:[(0,a.jsx)("h2",{className:y.default.cardTitle,children:"إعدادات الإشعارات"}),(0,a.jsx)("p",{className:y.default.cardDescription,children:"تحكم في كيفية تلقي الإشعارات"}),(0,a.jsxs)("div",{className:y.default.toggleList,children:[(0,a.jsxs)("div",{className:y.default.toggleItem,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:y.default.toggleTitle,children:"إشعارات البريد الإلكتروني"}),(0,a.jsx)("p",{className:y.default.toggleDescription,children:"استلام الإشعارات عبر البريد الإلكتروني"})]}),(0,a.jsxs)("label",{className:y.default.toggle,children:[(0,a.jsx)("input",{type:"checkbox",checked:S.emailNotifications,onChange:e=>k({...S,emailNotifications:e.target.checked})}),(0,a.jsx)("span",{className:y.default.slider})]})]}),(0,a.jsxs)("div",{className:y.default.toggleItem,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:y.default.toggleTitle,children:"إشعارات المتصفح"}),(0,a.jsx)("p",{className:y.default.toggleDescription,children:"إشعارات فورية في المتصفح"})]}),(0,a.jsxs)("label",{className:y.default.toggle,children:[(0,a.jsx)("input",{type:"checkbox",checked:S.browserNotifications,onChange:e=>k({...S,browserNotifications:e.target.checked})}),(0,a.jsx)("span",{className:y.default.slider})]})]}),(0,a.jsxs)("div",{className:y.default.toggleItem,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:y.default.toggleTitle,children:"تنبيهات المدرسين"}),(0,a.jsx)("p",{className:y.default.toggleDescription,children:"تلقي تنبيهات عند إضافة أو تحديث بيانات المدرسين"})]}),(0,a.jsxs)("label",{className:y.default.toggle,children:[(0,a.jsx)("input",{type:"checkbox",checked:S.teacherAlerts,onChange:e=>k({...S,teacherAlerts:e.target.checked})}),(0,a.jsx)("span",{className:y.default.slider})]})]}),(0,a.jsxs)("div",{className:y.default.toggleItem,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:y.default.toggleTitle,children:"تنبيهات الحضور"}),(0,a.jsx)("p",{className:y.default.toggleDescription,children:"تلقي تنبيهات عند تسجيل الحضور والغياب"})]}),(0,a.jsxs)("label",{className:y.default.toggle,children:[(0,a.jsx)("input",{type:"checkbox",checked:S.attendanceAlerts,onChange:e=>k({...S,attendanceAlerts:e.target.checked})}),(0,a.jsx)("span",{className:y.default.slider})]})]}),(0,a.jsxs)("div",{className:y.default.toggleItem,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:y.default.toggleTitle,children:"التقرير الأسبوعي"}),(0,a.jsx)("p",{className:y.default.toggleDescription,children:"استلام ملخص أسبوعي عبر البريد الإلكتروني"})]}),(0,a.jsxs)("label",{className:y.default.toggle,children:[(0,a.jsx)("input",{type:"checkbox",checked:S.weeklyReport,onChange:e=>k({...S,weeklyReport:e.target.checked})}),(0,a.jsx)("span",{className:y.default.slider})]})]})]}),(0,a.jsxs)("button",{className:y.default.saveBtn,onClick:B,disabled:c,children:[j?(0,a.jsx)(h.Check,{size:18}):(0,a.jsx)(u,{size:18}),j?"تم الحفظ":"حفظ الإعدادات"]})]}),"users"===e&&(0,a.jsx)(w,{})]})]}),j&&(0,a.jsxs)("div",{className:y.default.toast,children:[(0,a.jsx)(h.Check,{size:18}),"تم حفظ التغييرات بنجاح"]})]})}function w(){let[e,t]=(0,s.useState)("teachers"),l=[{id:"teachers",label:"المدرسون",icon:n.Users},{id:"students",label:"الطلاب",icon:r.GraduationCap},{id:"parents",label:"أولياء الأمور",icon:c.UserCheck},{id:"accounts",label:"حسابات المدرسين",icon:b}];return(0,a.jsxs)("div",{className:y.default.card,children:[(0,a.jsx)("h2",{className:y.default.cardTitle,children:"إدارة المستخدمين"}),(0,a.jsx)("p",{className:y.default.cardDescription,children:"إضافة وتعديل وحذف المستخدمين في النظام"}),(0,a.jsx)("div",{className:y.default.subTabs,children:l.map(s=>(0,a.jsxs)("button",{className:`${y.default.subTab} ${e===s.id?y.default.subTabActive:""}`,onClick:()=>t(s.id),children:[(0,a.jsx)(s.icon,{size:16}),s.label]},s.id))}),(0,a.jsxs)("div",{className:y.default.subTabContent,children:["teachers"===e&&(0,a.jsx)(C,{}),"students"===e&&(0,a.jsx)(k,{}),"parents"===e&&(0,a.jsx)(P,{}),"accounts"===e&&(0,a.jsx)(B,{})]})]})}function C(){let[e,t]=(0,s.useState)([]),[l,d]=(0,s.useState)(!0),[i,r]=(0,s.useState)(""),[c,o]=(0,s.useState)(1),[u,h]=(0,s.useState)(1),[m,f]=(0,s.useState)(!1),[g,b]=(0,s.useState)(null),q=(0,s.useCallback)(async()=>{d(!0);try{let e=new URLSearchParams({page:c.toString(),limit:"10"});i&&e.set("search",i);let a=await fetch(`/api/teachers?${e}`),s=await a.json();t(s.teachers||[]),h(s.pagination?.totalPages||1)}catch(e){console.error("Failed to fetch teachers:",e)}finally{d(!1)}},[c,i]);(0,s.useEffect)(()=>{q()},[q]);let w=async e=>{if(confirm("هل أنت متأكد من حذف هذا المدرس؟"))try{await fetch(`/api/teachers/${e}`,{method:"DELETE"}),q()}catch(e){console.error("Failed to delete teacher:",e)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:y.default.sectionHeader,children:[(0,a.jsxs)("div",{className:y.default.searchBox,children:[(0,a.jsx)(x.Search,{size:18}),(0,a.jsx)("input",{type:"text",placeholder:"بحث بالاسم أو الرقم الوظيفي...",value:i,onChange:e=>{r(e.target.value),o(1)}})]}),(0,a.jsxs)("button",{className:y.default.addBtn,onClick:()=>{b(null),f(!0)},children:[(0,a.jsx)(j.Plus,{size:18}),"إضافة مدرس"]})]}),l?(0,a.jsx)("div",{className:y.default.loadingState,children:(0,a.jsx)("div",{className:y.default.loader})}):0===e.length?(0,a.jsxs)("div",{className:y.default.emptyState,children:[(0,a.jsx)(n.Users,{size:40}),(0,a.jsx)("p",{children:"لا يوجد مدرسين"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:y.default.tableWrap,children:(0,a.jsxs)("table",{className:y.default.table,children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"الرقم الوظيفي"}),(0,a.jsx)("th",{children:"الاسم"}),(0,a.jsx)("th",{children:"القسم"}),(0,a.jsx)("th",{children:"الحالة"}),(0,a.jsx)("th",{children:"الإجراءات"})]})}),(0,a.jsx)("tbody",{children:e.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:y.default.mono,children:e.employeeId}),(0,a.jsx)("td",{children:e.name}),(0,a.jsx)("td",{children:e.department?.name||"-"}),(0,a.jsx)("td",{children:(0,a.jsx)("span",{className:`${y.default.badge} ${"active"===e.status?y.default.badgeGreen:y.default.badgeGray}`,children:"active"===e.status?"نشط":"غير نشط"})}),(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:y.default.actions,children:[(0,a.jsx)("button",{className:y.default.editBtn,onClick:()=>{b(e),f(!0)},children:(0,a.jsx)(p.Edit,{size:16})}),(0,a.jsx)("button",{className:y.default.deleteBtn,onClick:()=>w(e.id),children:(0,a.jsx)(_.Trash2,{size:16})})]})})]},e.id))})]})}),u>1&&(0,a.jsxs)("div",{className:y.default.pagination,children:[(0,a.jsx)("button",{disabled:1===c,onClick:()=>o(e=>e-1),children:(0,a.jsx)(v.ChevronRight,{size:16})}),(0,a.jsxs)("span",{children:[c," / ",u]}),(0,a.jsx)("button",{disabled:c===u,onClick:()=>o(e=>e+1),children:(0,a.jsx)(N.ChevronLeft,{size:16})})]})]}),m&&(0,a.jsx)(S,{teacher:g,onClose:()=>{f(!1),b(null)},onSave:()=>{f(!1),b(null),q()}})]})}function S({teacher:e,onClose:t,onSave:l}){let[d,i]=(0,s.useState)([]),[n,r]=(0,s.useState)([]),[c,o]=(0,s.useState)({employeeId:e?.employeeId||"",name:e?.name||"",email:e?.email||"",phone:e?.phone||"",departmentId:e?.department?.id?.toString()||"",subjectId:e?.subject?.id?.toString()||"",status:e?.status||"active"}),[u,h]=(0,s.useState)(!1),[m,f]=(0,s.useState)("");(0,s.useEffect)(()=>{fetch("/api/departments").then(e=>e.json()).then(e=>i(e.departments||[])),fetch("/api/subjects").then(e=>e.json()).then(e=>r(e.subjects||[]))},[]);let j=async a=>{if(a.preventDefault(),!c.employeeId||!c.name)return void f("الرقم الوظيفي والاسم مطلوبان");h(!0),f("");try{let a=await fetch(e?`/api/teachers/${e.id}`:"/api/teachers",{method:e?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),s=await a.json();if(!a.ok)return void f(s.error||"حدث خطأ");l()}catch{f("حدث خطأ في الاتصال")}finally{h(!1)}};return(0,a.jsx)("div",{className:y.default.modalOverlay,onClick:t,children:(0,a.jsxs)("div",{className:y.default.modal,onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:y.default.modalHeader,children:[(0,a.jsx)("h2",{children:e?"تعديل المدرس":"إضافة مدرس جديد"}),(0,a.jsx)("button",{onClick:t,children:(0,a.jsx)(g.X,{size:20})})]}),(0,a.jsxs)("form",{onSubmit:j,className:y.default.modalForm,children:[(0,a.jsxs)("div",{className:y.default.formRow,children:[(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"الرقم الوظيفي *"}),(0,a.jsx)("input",{type:"text",className:y.default.input,value:c.employeeId,onChange:e=>o({...c,employeeId:e.target.value}),required:!0,disabled:!!e})]}),(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"الاسم *"}),(0,a.jsx)("input",{type:"text",className:y.default.input,value:c.name,onChange:e=>o({...c,name:e.target.value}),required:!0})]})]}),(0,a.jsxs)("div",{className:y.default.formRow,children:[(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"البريد الإلكتروني"}),(0,a.jsx)("input",{type:"email",className:y.default.input,value:c.email,onChange:e=>o({...c,email:e.target.value})})]}),(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"رقم الهاتف"}),(0,a.jsx)("input",{type:"tel",className:y.default.input,value:c.phone,onChange:e=>o({...c,phone:e.target.value})})]})]}),(0,a.jsxs)("div",{className:y.default.formRow,children:[(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"القسم"}),(0,a.jsxs)("select",{className:y.default.select,value:c.departmentId,onChange:e=>o({...c,departmentId:e.target.value}),children:[(0,a.jsx)("option",{value:"",children:"اختر القسم"}),d.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"المادة"}),(0,a.jsxs)("select",{className:y.default.select,value:c.subjectId,onChange:e=>o({...c,subjectId:e.target.value}),children:[(0,a.jsx)("option",{value:"",children:"اختر المادة"}),n.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"الحالة"}),(0,a.jsxs)("select",{className:y.default.select,value:c.status,onChange:e=>o({...c,status:e.target.value}),children:[(0,a.jsx)("option",{value:"active",children:"نشط"}),(0,a.jsx)("option",{value:"inactive",children:"غير نشط"}),(0,a.jsx)("option",{value:"on_leave",children:"إجازة"})]})]}),m&&(0,a.jsx)("div",{className:y.default.formError,children:m}),(0,a.jsxs)("div",{className:y.default.modalActions,children:[(0,a.jsx)("button",{type:"button",onClick:t,className:y.default.cancelBtn,children:"إلغاء"}),(0,a.jsx)("button",{type:"submit",className:y.default.submitBtn,disabled:u,children:u?"جاري الحفظ...":"حفظ"})]})]})]})})}function k(){let[e,t]=(0,s.useState)([]),[l,d]=(0,s.useState)([]),[i,n]=(0,s.useState)(!0),[c,o]=(0,s.useState)(""),[u,h]=(0,s.useState)(1),[m,f]=(0,s.useState)(1),[g,b]=(0,s.useState)(!1),[q,w]=(0,s.useState)(null),C=(0,s.useCallback)(async()=>{n(!0);try{let e=new URLSearchParams({page:u.toString(),limit:"10"});c&&e.set("search",c);let a=await fetch(`/api/students?${e}`),s=await a.json();t(s.students||[]),f(s.pagination?.totalPages||1)}catch(e){console.error("Failed to fetch students:",e)}finally{n(!1)}},[u,c]);(0,s.useEffect)(()=>{C()},[C]),(0,s.useEffect)(()=>{fetch("/api/parents?limit=100").then(e=>e.json()).then(e=>d(e.parents||[]))},[]);let S=async e=>{if(confirm("هل أنت متأكد من حذف هذا الطالب؟"))try{let a=await fetch(`/api/students?id=${e}`,{method:"DELETE"});if(a.ok)C();else{let e=await a.json();alert(e.error||"فشل حذف الطالب")}}catch(e){console.error("Failed to delete student:",e)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:y.default.sectionHeader,children:[(0,a.jsxs)("div",{className:y.default.searchBox,children:[(0,a.jsx)(x.Search,{size:18}),(0,a.jsx)("input",{type:"text",placeholder:"بحث بالاسم أو الرقم الطلابي...",value:c,onChange:e=>{o(e.target.value),h(1)}})]}),(0,a.jsxs)("button",{className:y.default.addBtn,onClick:()=>{w(null),b(!0)},children:[(0,a.jsx)(j.Plus,{size:18}),"إضافة طالب"]})]}),i?(0,a.jsx)("div",{className:y.default.loadingState,children:(0,a.jsx)("div",{className:y.default.loader})}):0===e.length?(0,a.jsxs)("div",{className:y.default.emptyState,children:[(0,a.jsx)(r.GraduationCap,{size:40}),(0,a.jsx)("p",{children:"لا يوجد طلاب"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:y.default.tableWrap,children:(0,a.jsxs)("table",{className:y.default.table,children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"الرقم الطلابي"}),(0,a.jsx)("th",{children:"الاسم"}),(0,a.jsx)("th",{children:"الصف"}),(0,a.jsx)("th",{children:"ولي الأمر"}),(0,a.jsx)("th",{children:"الإجراءات"})]})}),(0,a.jsx)("tbody",{children:e.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:y.default.mono,children:e.studentId}),(0,a.jsx)("td",{children:e.name}),(0,a.jsx)("td",{children:e.grade||"-"}),(0,a.jsx)("td",{children:e.parent?.name||"-"}),(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:y.default.actions,children:[(0,a.jsx)("button",{className:y.default.editBtn,onClick:()=>{w(e),b(!0)},children:(0,a.jsx)(p.Edit,{size:16})}),(0,a.jsx)("button",{className:y.default.deleteBtn,onClick:()=>S(e.id),children:(0,a.jsx)(_.Trash2,{size:16})})]})})]},e.id))})]})}),m>1&&(0,a.jsxs)("div",{className:y.default.pagination,children:[(0,a.jsx)("button",{disabled:1===u,onClick:()=>h(e=>e-1),children:(0,a.jsx)(v.ChevronRight,{size:16})}),(0,a.jsxs)("span",{children:[u," / ",m]}),(0,a.jsx)("button",{disabled:u===m,onClick:()=>h(e=>e+1),children:(0,a.jsx)(N.ChevronLeft,{size:16})})]})]}),g&&(0,a.jsx)(W,{student:q,parents:l,grades:["الأول","الثاني","الثالث","الرابع","الخامس","السادس","السابع","الثامن","التاسع","العاشر","الحادي عشر","الثاني عشر"],onClose:()=>{b(!1),w(null)},onSave:()=>{b(!1),w(null),C()}})]})}function W({student:e,parents:t,grades:l,onClose:d,onSave:i}){let[n,r]=(0,s.useState)({studentId:e?.studentId||"",name:e?.name||"",email:e?.email||"",phone:e?.phone||"",grade:e?.grade||"",parentId:e?.parent?.id?.toString()||""}),[c,o]=(0,s.useState)(!1),[u,h]=(0,s.useState)(""),m=async a=>{if(a.preventDefault(),!n.studentId||!n.name)return void h("الرقم الطلابي والاسم مطلوبان");o(!0),h("");try{let a=e?`/api/students?id=${e.id}`:"/api/students",s=await fetch(a,{method:e?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),t=await s.json();if(!s.ok)return void h(t.error||"حدث خطأ");i()}catch{h("حدث خطأ في الاتصال")}finally{o(!1)}};return(0,a.jsx)("div",{className:y.default.modalOverlay,onClick:d,children:(0,a.jsxs)("div",{className:y.default.modal,onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:y.default.modalHeader,children:[(0,a.jsx)("h2",{children:e?"تعديل الطالب":"إضافة طالب جديد"}),(0,a.jsx)("button",{onClick:d,children:(0,a.jsx)(g.X,{size:20})})]}),(0,a.jsxs)("form",{onSubmit:m,className:y.default.modalForm,children:[(0,a.jsxs)("div",{className:y.default.formRow,children:[(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"الرقم الطلابي *"}),(0,a.jsx)("input",{type:"text",className:y.default.input,value:n.studentId,onChange:e=>r({...n,studentId:e.target.value}),required:!0,disabled:!!e})]}),(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"الاسم *"}),(0,a.jsx)("input",{type:"text",className:y.default.input,value:n.name,onChange:e=>r({...n,name:e.target.value}),required:!0})]})]}),(0,a.jsxs)("div",{className:y.default.formRow,children:[(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"البريد الإلكتروني"}),(0,a.jsx)("input",{type:"email",className:y.default.input,value:n.email,onChange:e=>r({...n,email:e.target.value})})]}),(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"رقم الهاتف"}),(0,a.jsx)("input",{type:"tel",className:y.default.input,value:n.phone,onChange:e=>r({...n,phone:e.target.value})})]})]}),(0,a.jsxs)("div",{className:y.default.formRow,children:[(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"الصف"}),(0,a.jsxs)("select",{className:y.default.select,value:n.grade,onChange:e=>r({...n,grade:e.target.value}),children:[(0,a.jsx)("option",{value:"",children:"اختر الصف"}),l.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"ولي الأمر"}),(0,a.jsxs)("select",{className:y.default.select,value:n.parentId,onChange:e=>r({...n,parentId:e.target.value}),children:[(0,a.jsx)("option",{value:"",children:"اختر ولي الأمر"}),t.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),u&&(0,a.jsx)("div",{className:y.default.formError,children:u}),(0,a.jsxs)("div",{className:y.default.modalActions,children:[(0,a.jsx)("button",{type:"button",onClick:d,className:y.default.cancelBtn,children:"إلغاء"}),(0,a.jsx)("button",{type:"submit",className:y.default.submitBtn,disabled:c,children:c?"جاري الحفظ...":"حفظ"})]})]})]})})}function P(){let[e,t]=(0,s.useState)([]),[l,d]=(0,s.useState)(!0),[i,n]=(0,s.useState)(""),[r,o]=(0,s.useState)(1),[u,h]=(0,s.useState)(1),[m,f]=(0,s.useState)(!1),[g,b]=(0,s.useState)(null),q=(0,s.useCallback)(async()=>{d(!0);try{let e=new URLSearchParams({page:r.toString(),limit:"10"});i&&e.set("search",i);let a=await fetch(`/api/parents?${e}`),s=await a.json();t(s.parents||[]),h(s.pagination?.totalPages||1)}catch(e){console.error("Failed to fetch parents:",e)}finally{d(!1)}},[r,i]);(0,s.useEffect)(()=>{q()},[q]);let w=async e=>{if(confirm("هل أنت متأكد من حذف ولي الأمر؟"))try{let a=await fetch(`/api/parents?id=${e}`,{method:"DELETE"});if(a.ok)q();else{let e=await a.json();alert(e.error||"فشل حذف ولي الأمر")}}catch(e){console.error("Failed to delete parent:",e)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:y.default.sectionHeader,children:[(0,a.jsxs)("div",{className:y.default.searchBox,children:[(0,a.jsx)(x.Search,{size:18}),(0,a.jsx)("input",{type:"text",placeholder:"بحث بالاسم أو البريد الإلكتروني...",value:i,onChange:e=>{n(e.target.value),o(1)}})]}),(0,a.jsxs)("button",{className:y.default.addBtn,onClick:()=>{b(null),f(!0)},children:[(0,a.jsx)(j.Plus,{size:18}),"إضافة ولي أمر"]})]}),l?(0,a.jsx)("div",{className:y.default.loadingState,children:(0,a.jsx)("div",{className:y.default.loader})}):0===e.length?(0,a.jsxs)("div",{className:y.default.emptyState,children:[(0,a.jsx)(c.UserCheck,{size:40}),(0,a.jsx)("p",{children:"لا يوجد أولياء أمور"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:y.default.tableWrap,children:(0,a.jsxs)("table",{className:y.default.table,children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"الاسم"}),(0,a.jsx)("th",{children:"البريد الإلكتروني"}),(0,a.jsx)("th",{children:"الهاتف"}),(0,a.jsx)("th",{children:"الأبناء"}),(0,a.jsx)("th",{children:"الإجراءات"})]})}),(0,a.jsx)("tbody",{children:e.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.name}),(0,a.jsx)("td",{className:y.default.mono,children:e.email}),(0,a.jsx)("td",{children:e.phone||"-"}),(0,a.jsx)("td",{children:(0,a.jsxs)("span",{className:y.default.badge,children:[e.students.length," طالب"]})}),(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:y.default.actions,children:[(0,a.jsx)("button",{className:y.default.editBtn,onClick:()=>{b(e),f(!0)},children:(0,a.jsx)(p.Edit,{size:16})}),(0,a.jsx)("button",{className:y.default.deleteBtn,onClick:()=>w(e.id),children:(0,a.jsx)(_.Trash2,{size:16})})]})})]},e.id))})]})}),u>1&&(0,a.jsxs)("div",{className:y.default.pagination,children:[(0,a.jsx)("button",{disabled:1===r,onClick:()=>o(e=>e-1),children:(0,a.jsx)(v.ChevronRight,{size:16})}),(0,a.jsxs)("span",{children:[r," / ",u]}),(0,a.jsx)("button",{disabled:r===u,onClick:()=>o(e=>e+1),children:(0,a.jsx)(N.ChevronLeft,{size:16})})]})]}),m&&(0,a.jsx)(T,{parent:g,onClose:()=>{f(!1),b(null)},onSave:()=>{f(!1),b(null),q()}})]})}function T({parent:e,onClose:t,onSave:l}){let[d,i]=(0,s.useState)({name:e?.name||"",email:e?.email||"",phone:e?.phone||"",password:""}),[n,r]=(0,s.useState)(!1),[c,o]=(0,s.useState)(""),u=async a=>{if(a.preventDefault(),!d.name||!d.email)return void o("الاسم والبريد الإلكتروني مطلوبان");if(!e&&!d.password)return void o("كلمة المرور مطلوبة");r(!0),o("");let s={...d};!d.password&&e&&delete s.password;try{let a=e?`/api/parents?id=${e.id}`:"/api/parents",t=await fetch(a,{method:e?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),d=await t.json();if(!t.ok)return void o(d.error||"حدث خطأ");l()}catch{o("حدث خطأ في الاتصال")}finally{r(!1)}};return(0,a.jsx)("div",{className:y.default.modalOverlay,onClick:t,children:(0,a.jsxs)("div",{className:y.default.modal,onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:y.default.modalHeader,children:[(0,a.jsx)("h2",{children:e?"تعديل ولي الأمر":"إضافة ولي أمر جديد"}),(0,a.jsx)("button",{onClick:t,children:(0,a.jsx)(g.X,{size:20})})]}),(0,a.jsxs)("form",{onSubmit:u,className:y.default.modalForm,children:[(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"الاسم *"}),(0,a.jsx)("input",{type:"text",className:y.default.input,value:d.name,onChange:e=>i({...d,name:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"البريد الإلكتروني *"}),(0,a.jsx)("input",{type:"email",className:y.default.input,value:d.email,onChange:e=>i({...d,email:e.target.value}),required:!0,disabled:!!e})]}),(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"رقم الهاتف"}),(0,a.jsx)("input",{type:"tel",className:y.default.input,value:d.phone,onChange:e=>i({...d,phone:e.target.value})})]}),(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:e?"كلمة المرور (اتركها فارغة للإبقاء)":"كلمة المرور *"}),(0,a.jsx)("input",{type:"password",className:y.default.input,value:d.password,onChange:e=>i({...d,password:e.target.value}),required:!e})]}),c&&(0,a.jsx)("div",{className:y.default.formError,children:c}),(0,a.jsxs)("div",{className:y.default.modalActions,children:[(0,a.jsx)("button",{type:"button",onClick:t,className:y.default.cancelBtn,children:"إلغاء"}),(0,a.jsx)("button",{type:"submit",className:y.default.submitBtn,disabled:n,children:n?"جاري الحفظ...":"حفظ"})]})]})]})})}function B(){let[e,t]=(0,s.useState)([]),[l,i]=(0,s.useState)(!0),[n,r]=(0,s.useState)(""),[c,o]=(0,s.useState)("all"),[u,h]=(0,s.useState)(!1),[m,f]=(0,s.useState)(!1),[p,_]=(0,s.useState)(null),g=(0,s.useCallback)(async()=>{i(!0);try{let e=new URLSearchParams;"with"===c&&e.set("hasAccount","true"),"without"===c&&e.set("hasAccount","false");let a=await fetch(`/api/teachers/accounts?${e}`),s=await a.json();t(s.teachers||[])}catch(e){console.error("Failed to fetch teacher accounts:",e)}finally{i(!1)}},[c]);(0,s.useEffect)(()=>{g()},[g]);let v=e.filter(e=>e.name.includes(n)||e.employeeId.includes(n));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:y.default.sectionHeader,children:[(0,a.jsxs)("div",{className:y.default.searchBox,children:[(0,a.jsx)(x.Search,{size:18}),(0,a.jsx)("input",{type:"text",placeholder:"بحث بالاسم أو الرقم الوظيفي...",value:n,onChange:e=>r(e.target.value)})]}),(0,a.jsxs)("select",{className:y.default.filterSelect,value:c,onChange:e=>o(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"جميع المدرسين"}),(0,a.jsx)("option",{value:"with",children:"لديهم حساب"}),(0,a.jsx)("option",{value:"without",children:"بدون حساب"})]})]}),l?(0,a.jsx)("div",{className:y.default.loadingState,children:(0,a.jsx)("div",{className:y.default.loader})}):0===v.length?(0,a.jsxs)("div",{className:y.default.emptyState,children:[(0,a.jsx)(b,{size:40}),(0,a.jsx)("p",{children:"لا يوجد مدرسين"})]}):(0,a.jsx)("div",{className:y.default.tableWrap,children:(0,a.jsxs)("table",{className:y.default.table,children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"الرقم الوظيفي"}),(0,a.jsx)("th",{children:"الاسم"}),(0,a.jsx)("th",{children:"القسم"}),(0,a.jsx)("th",{children:"حالة الحساب"}),(0,a.jsx)("th",{children:"البريد الإلكتروني"}),(0,a.jsx)("th",{children:"الإجراءات"})]})}),(0,a.jsx)("tbody",{children:v.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:y.default.mono,children:e.employeeId}),(0,a.jsx)("td",{children:e.name}),(0,a.jsx)("td",{children:e.department||"-"}),(0,a.jsx)("td",{children:(0,a.jsx)("span",{className:`${y.default.badge} ${e.hasAccount?y.default.badgeGreen:y.default.badgeGray}`,children:e.hasAccount?"لديه حساب":"بدون حساب"})}),(0,a.jsx)("td",{dir:"ltr",children:e.accountEmail||"-"}),(0,a.jsx)("td",{children:(0,a.jsx)("div",{className:y.default.actions,children:e.hasAccount?(0,a.jsx)("button",{className:y.default.editBtn,onClick:()=>{_(e),f(!0)},title:"إعادة تعيين كلمة المرور",children:(0,a.jsx)(d.Lock,{size:16})}):(0,a.jsxs)("button",{className:y.default.addBtn,onClick:()=>{_(e),h(!0)},style:{padding:"0.4rem 0.8rem",fontSize:"0.8rem"},children:[(0,a.jsx)(j.Plus,{size:14}),"إنشاء حساب"]})})})]},e.id))})]})}),u&&p&&(0,a.jsx)(z,{teacher:p,onClose:()=>{h(!1),_(null)},onSave:()=>{h(!1),_(null),g()}}),m&&p&&(0,a.jsx)(I,{teacher:p,onClose:()=>{f(!1),_(null)},onSave:()=>{f(!1),_(null)}})]})}function z({teacher:e,onClose:t,onSave:l}){let[d,i]=(0,s.useState)({email:e.email||"",password:"",confirmPassword:""}),[n,r]=(0,s.useState)(!1),[c,o]=(0,s.useState)(""),[u,h]=(0,s.useState)(!1),j=async a=>{if(a.preventDefault(),!d.email||!d.password)return void o("البريد الإلكتروني وكلمة المرور مطلوبين");if(d.password!==d.confirmPassword)return void o("كلمات المرور غير متطابقة");if(d.password.length<8)return void o("كلمة المرور يجب أن تكون 8 أحرف على الأقل");r(!0),o("");try{let a=await fetch("/api/teachers/accounts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacherId:e.id,email:d.email,password:d.password,name:e.name})}),s=await a.json();if(!a.ok)return void o(s.error||"حدث خطأ في إنشاء الحساب");alert("تم إنشاء حساب المدرس بنجاح"),l()}catch{o("حدث خطأ في الاتصال")}finally{r(!1)}};return(0,a.jsx)("div",{className:y.default.modalOverlay,onClick:t,children:(0,a.jsxs)("div",{className:y.default.modal,onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:y.default.modalHeader,children:[(0,a.jsxs)("h2",{children:["إنشاء حساب للمدرس: ",e.name]}),(0,a.jsx)("button",{onClick:t,children:(0,a.jsx)(g.X,{size:20})})]}),(0,a.jsxs)("form",{onSubmit:j,className:y.default.modalForm,children:[(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"البريد الإلكتروني *"}),(0,a.jsx)("input",{type:"email",className:y.default.input,value:d.email,onChange:e=>i({...d,email:e.target.value}),required:!0,dir:"ltr"})]}),(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"كلمة المرور *"}),(0,a.jsxs)("div",{className:y.default.passwordInput,children:[(0,a.jsx)("input",{type:u?"text":"password",className:y.default.input,value:d.password,onChange:e=>i({...d,password:e.target.value}),required:!0,dir:"ltr",placeholder:"8 أحرف على الأقل"}),(0,a.jsx)("button",{type:"button",className:y.default.eyeBtn,onClick:()=>h(!u),children:u?(0,a.jsx)(f.EyeOff,{size:18}):(0,a.jsx)(m.Eye,{size:18})})]})]}),(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"تأكيد كلمة المرور *"}),(0,a.jsx)("input",{type:"password",className:y.default.input,value:d.confirmPassword,onChange:e=>i({...d,confirmPassword:e.target.value}),required:!0,dir:"ltr"})]}),c&&(0,a.jsx)("div",{className:y.default.formError,children:c}),(0,a.jsxs)("div",{className:y.default.modalActions,children:[(0,a.jsx)("button",{type:"button",onClick:t,className:y.default.cancelBtn,children:"إلغاء"}),(0,a.jsx)("button",{type:"submit",className:y.default.submitBtn,disabled:n,children:n?"جاري الإنشاء...":"إنشاء الحساب"})]})]})]})})}function I({teacher:e,onClose:t,onSave:l}){let[d,i]=(0,s.useState)({password:"",confirmPassword:""}),[n,r]=(0,s.useState)(!1),[c,o]=(0,s.useState)(""),[u,h]=(0,s.useState)(!1),j=async a=>{if(a.preventDefault(),d.password!==d.confirmPassword)return void o("كلمات المرور غير متطابقة");if(d.password.length<8)return void o("كلمة المرور يجب أن تكون 8 أحرف على الأقل");r(!0),o("");try{let a=await fetch("/api/teachers/accounts",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacherId:e.id,newPassword:d.password})}),s=await a.json();if(!a.ok)return void o(s.error||"حدث خطأ");alert("تم تحديث كلمة المرور بنجاح"),l()}catch{o("حدث خطأ في الاتصال")}finally{r(!1)}};return(0,a.jsx)("div",{className:y.default.modalOverlay,onClick:t,children:(0,a.jsxs)("div",{className:y.default.modal,onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:y.default.modalHeader,children:[(0,a.jsxs)("h2",{children:["إعادة تعيين كلمة المرور: ",e.name]}),(0,a.jsx)("button",{onClick:t,children:(0,a.jsx)(g.X,{size:20})})]}),(0,a.jsxs)("form",{onSubmit:j,className:y.default.modalForm,children:[(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"كلمة المرور الجديدة *"}),(0,a.jsxs)("div",{className:y.default.passwordInput,children:[(0,a.jsx)("input",{type:u?"text":"password",className:y.default.input,value:d.password,onChange:e=>i({...d,password:e.target.value}),required:!0,dir:"ltr",placeholder:"8 أحرف على الأقل"}),(0,a.jsx)("button",{type:"button",className:y.default.eyeBtn,onClick:()=>h(!u),children:u?(0,a.jsx)(f.EyeOff,{size:18}):(0,a.jsx)(m.Eye,{size:18})})]})]}),(0,a.jsxs)("div",{className:y.default.formGroup,children:[(0,a.jsx)("label",{className:y.default.label,children:"تأكيد كلمة المرور *"}),(0,a.jsx)("input",{type:"password",className:y.default.input,value:d.confirmPassword,onChange:e=>i({...d,confirmPassword:e.target.value}),required:!0,dir:"ltr"})]}),c&&(0,a.jsx)("div",{className:y.default.formError,children:c}),(0,a.jsxs)("div",{className:y.default.modalActions,children:[(0,a.jsx)("button",{type:"button",onClick:t,className:y.default.cancelBtn,children:"إلغاء"}),(0,a.jsx)("button",{type:"submit",className:y.default.submitBtn,disabled:n,children:n?"جاري التحديث...":"تحديث كلمة المرور"})]})]})]})})}e.s(["default",()=>q],59772)}]);