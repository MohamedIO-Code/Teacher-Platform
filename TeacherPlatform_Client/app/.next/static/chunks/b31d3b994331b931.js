(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7233,e=>{"use strict";let a=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>a],7233)},63059,e=>{"use strict";let a=(0,e.i(75254).default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);e.s(["ChevronRight",()=>a],63059)},87130,e=>{"use strict";let a=(0,e.i(75254).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["Filter",()=>a],87130)},27612,e=>{"use strict";let a=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>a],27612)},55436,88511,e=>{"use strict";var a=e.i(75254);let t=(0,a.default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436);let s=(0,a.default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["Edit",()=>s],88511)},32095,e=>{"use strict";let a=(0,e.i(75254).default)("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);e.s(["GraduationCap",()=>a],32095)},73968,e=>{e.v({actions:"students-module__rxau4q__actions",addButton:"students-module__rxau4q__addButton",avatar:"students-module__rxau4q__avatar",cancelBtn:"students-module__rxau4q__cancelBtn",container:"students-module__rxau4q__container",deleteBtn:"students-module__rxau4q__deleteBtn",editBtn:"students-module__rxau4q__editBtn",email:"students-module__rxau4q__email",empty:"students-module__rxau4q__empty",filterGroup:"students-module__rxau4q__filterGroup",filters:"students-module__rxau4q__filters",formError:"students-module__rxau4q__formError",formGroup:"students-module__rxau4q__formGroup",formRow:"students-module__rxau4q__formRow",header:"students-module__rxau4q__header",headerContent:"students-module__rxau4q__headerContent",headerIcon:"students-module__rxau4q__headerIcon",loader:"students-module__rxau4q__loader",loading:"students-module__rxau4q__loading",modal:"students-module__rxau4q__modal",modalActions:"students-module__rxau4q__modalActions",modalForm:"students-module__rxau4q__modalForm",modalHeader:"students-module__rxau4q__modalHeader",modalOverlay:"students-module__rxau4q__modalOverlay",name:"students-module__rxau4q__name",nameCell:"students-module__rxau4q__nameCell",pagination:"students-module__rxau4q__pagination",participationBadge:"students-module__rxau4q__participationBadge",searchGroup:"students-module__rxau4q__searchGroup",spin:"students-module__rxau4q__spin",studentId:"students-module__rxau4q__studentId",submitBtn:"students-module__rxau4q__submitBtn",subtitle:"students-module__rxau4q__subtitle",table:"students-module__rxau4q__table",tableContainer:"students-module__rxau4q__tableContainer",title:"students-module__rxau4q__title"})},86483,e=>{"use strict";var a=e.i(43476),t=e.i(71645),s=e.i(32095),l=e.i(7233),d=e.i(55436),n=e.i(87130),r=e.i(63059),i=e.i(73375),u=e.i(37727),o=e.i(88511),c=e.i(27612),h=e.i(73968);function m(){let[e,u]=(0,t.useState)([]),[m,x]=(0,t.useState)([]),[p,j]=(0,t.useState)(!0),[f,v]=(0,t.useState)(""),[g,y]=(0,t.useState)(""),[N,b]=(0,t.useState)(1),[q,C]=(0,t.useState)(1),[k,S]=(0,t.useState)(!1),[B,G]=(0,t.useState)(null),w=(0,t.useCallback)(async()=>{j(!0);try{let e=new URLSearchParams({page:N.toString(),limit:"15"});f&&e.set("search",f),g&&e.set("grade",g);let a=await fetch(`/api/students?${e}`),t=await a.json();u(t.students||[]),C(t.pagination?.totalPages||1)}catch(e){console.error("Failed to fetch students:",e)}finally{j(!1)}},[N,f,g]),I=async()=>{try{let e=await fetch("/api/parents?limit=100"),a=await e.json();x(a.parents||[])}catch(e){console.error("Failed to fetch parents:",e)}};(0,t.useEffect)(()=>{w()},[w]),(0,t.useEffect)(()=>{I()},[]);let z=async e=>{if(confirm("هل أنت متأكد من حذف هذا الطالب؟"))try{await fetch(`/api/students/${e}`,{method:"DELETE"}),w()}catch(e){console.error("Failed to delete student:",e)}},M=["الأول","الثاني","الثالث","الرابع","الخامس","السادس","السابع","الثامن","التاسع","العاشر","الحادي عشر","الثاني عشر"];return(0,a.jsxs)("div",{className:h.default.container,children:[(0,a.jsxs)("div",{className:h.default.header,children:[(0,a.jsxs)("div",{className:h.default.headerContent,children:[(0,a.jsx)("div",{className:h.default.headerIcon,children:(0,a.jsx)(s.GraduationCap,{size:28})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:h.default.title,children:"إدارة الطلاب"}),(0,a.jsx)("p",{className:h.default.subtitle,children:"إضافة ومتابعة بيانات الطلاب"})]})]}),(0,a.jsxs)("button",{className:h.default.addButton,onClick:()=>{G(null),S(!0)},children:[(0,a.jsx)(l.Plus,{size:18}),"إضافة طالب"]})]}),(0,a.jsxs)("div",{className:h.default.filters,children:[(0,a.jsxs)("div",{className:h.default.searchGroup,children:[(0,a.jsx)(d.Search,{size:18}),(0,a.jsx)("input",{type:"text",placeholder:"بحث بالاسم أو الرقم الطلابي...",value:f,onChange:e=>{v(e.target.value),b(1)}})]}),(0,a.jsxs)("div",{className:h.default.filterGroup,children:[(0,a.jsx)(n.Filter,{size:18}),(0,a.jsxs)("select",{value:g,onChange:e=>{y(e.target.value),b(1)},children:[(0,a.jsx)("option",{value:"",children:"جميع الصفوف"}),M.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]})]}),(0,a.jsxs)("div",{className:h.default.tableContainer,children:[p?(0,a.jsxs)("div",{className:h.default.loading,children:[(0,a.jsx)("div",{className:h.default.loader}),(0,a.jsx)("p",{children:"جاري التحميل..."})]}):0===e.length?(0,a.jsxs)("div",{className:h.default.empty,children:[(0,a.jsx)(s.GraduationCap,{size:48}),(0,a.jsx)("h3",{children:"لا يوجد طلاب"}),(0,a.jsx)("p",{children:"لم يتم إضافة طلاب بعد"})]}):(0,a.jsxs)("table",{className:h.default.table,children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"الرقم الطلابي"}),(0,a.jsx)("th",{children:"الاسم"}),(0,a.jsx)("th",{children:"الصف"}),(0,a.jsx)("th",{children:"ولي الأمر"}),(0,a.jsx)("th",{children:"المشاركات"}),(0,a.jsx)("th",{children:"الإجراءات"})]})}),(0,a.jsx)("tbody",{children:e.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:h.default.studentId,children:e.studentId}),(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:h.default.nameCell,children:[(0,a.jsx)("div",{className:h.default.avatar,children:e.name.charAt(0)}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:h.default.name,children:e.name}),e.email&&(0,a.jsx)("span",{className:h.default.email,children:e.email})]})]})}),(0,a.jsx)("td",{children:e.grade||"-"}),(0,a.jsx)("td",{children:e.parent?.name||"-"}),(0,a.jsx)("td",{children:(0,a.jsxs)("span",{className:h.default.participationBadge,children:[e._count.participations," نشاط"]})}),(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:h.default.actions,children:[(0,a.jsx)("button",{className:h.default.editBtn,onClick:()=>{G(e),S(!0)},children:(0,a.jsx)(o.Edit,{size:16})}),(0,a.jsx)("button",{className:h.default.deleteBtn,onClick:()=>z(e.id),children:(0,a.jsx)(c.Trash2,{size:16})})]})})]},e.id))})]}),q>1&&(0,a.jsxs)("div",{className:h.default.pagination,children:[(0,a.jsxs)("button",{disabled:1===N,onClick:()=>b(e=>e-1),children:[(0,a.jsx)(r.ChevronRight,{size:18}),"السابق"]}),(0,a.jsxs)("span",{children:["صفحة ",N," من ",q]}),(0,a.jsxs)("button",{disabled:N===q,onClick:()=>b(e=>e+1),children:["التالي",(0,a.jsx)(i.ChevronLeft,{size:18})]})]})]}),k&&(0,a.jsx)(_,{student:B,parents:m,grades:M,onClose:()=>{S(!1),G(null)},onSave:()=>{S(!1),G(null),w()}})]})}function _({student:e,parents:s,grades:l,onClose:d,onSave:n}){let[r,i]=(0,t.useState)({studentId:e?.studentId||"",name:e?.name||"",email:e?.email||"",phone:e?.phone||"",grade:e?.grade||"",parentId:e?.parent?.id?.toString()||""}),[o,c]=(0,t.useState)(!1),[m,_]=(0,t.useState)(""),x=async a=>{if(a.preventDefault(),!r.studentId||!r.name)return void _("الرقم الطلابي والاسم مطلوبان");c(!0),_("");try{let a=await fetch(e?`/api/students/${e.id}`:"/api/students",{method:e?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),t=await a.json();if(!a.ok)return void _(t.error||"حدث خطأ");n()}catch{_("حدث خطأ في الاتصال")}finally{c(!1)}};return(0,a.jsx)("div",{className:h.default.modalOverlay,onClick:d,children:(0,a.jsxs)("div",{className:h.default.modal,onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:h.default.modalHeader,children:[(0,a.jsx)("h2",{children:e?"تعديل الطالب":"إضافة طالب جديد"}),(0,a.jsx)("button",{onClick:d,children:(0,a.jsx)(u.X,{size:20})})]}),(0,a.jsxs)("form",{onSubmit:x,className:h.default.modalForm,children:[(0,a.jsxs)("div",{className:h.default.formRow,children:[(0,a.jsxs)("div",{className:h.default.formGroup,children:[(0,a.jsx)("label",{children:"الرقم الطلابي *"}),(0,a.jsx)("input",{type:"text",value:r.studentId,onChange:e=>i({...r,studentId:e.target.value}),placeholder:"أدخل الرقم الطلابي",required:!0,disabled:!!e})]}),(0,a.jsxs)("div",{className:h.default.formGroup,children:[(0,a.jsx)("label",{children:"الاسم الكامل *"}),(0,a.jsx)("input",{type:"text",value:r.name,onChange:e=>i({...r,name:e.target.value}),placeholder:"أدخل اسم الطالب",required:!0})]})]}),(0,a.jsxs)("div",{className:h.default.formRow,children:[(0,a.jsxs)("div",{className:h.default.formGroup,children:[(0,a.jsx)("label",{children:"البريد الإلكتروني"}),(0,a.jsx)("input",{type:"email",value:r.email,onChange:e=>i({...r,email:e.target.value}),placeholder:"البريد الإلكتروني"})]}),(0,a.jsxs)("div",{className:h.default.formGroup,children:[(0,a.jsx)("label",{children:"رقم الهاتف"}),(0,a.jsx)("input",{type:"tel",value:r.phone,onChange:e=>i({...r,phone:e.target.value}),placeholder:"رقم الهاتف"})]})]}),(0,a.jsxs)("div",{className:h.default.formRow,children:[(0,a.jsxs)("div",{className:h.default.formGroup,children:[(0,a.jsx)("label",{children:"الصف الدراسي"}),(0,a.jsxs)("select",{value:r.grade,onChange:e=>i({...r,grade:e.target.value}),children:[(0,a.jsx)("option",{value:"",children:"اختر الصف"}),l.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{className:h.default.formGroup,children:[(0,a.jsx)("label",{children:"ولي الأمر"}),(0,a.jsxs)("select",{value:r.parentId,onChange:e=>i({...r,parentId:e.target.value}),children:[(0,a.jsx)("option",{value:"",children:"اختر ولي الأمر"}),s.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),m&&(0,a.jsx)("div",{className:h.default.formError,children:m}),(0,a.jsxs)("div",{className:h.default.modalActions,children:[(0,a.jsx)("button",{type:"button",onClick:d,className:h.default.cancelBtn,children:"إلغاء"}),(0,a.jsx)("button",{type:"submit",className:h.default.submitBtn,disabled:o,children:o?"جاري الحفظ...":"حفظ"})]})]})]})})}e.s(["default",()=>m])}]);